<!-- usecases.xml {% comment %}
*****************************************************************************************
*                            WARNING: DO NOT EDIT THIS FILE                             *
*                                                                                       *
* This file is generated by SUSHI. Any edits you make to this file will be overwritten. *
*                                                                                       *
* To change the contents of this file, edit the original source file at:                *
* genomics-reporting/input/pages/usecases.xml                                           *
*****************************************************************************************
{% endcomment %} -->
<div xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://hl7.org/fhir ../../src-generated/schemas/fhir-single.xsd">

  <ol>
    <li>As the CG IG heavily utilizes Observation.component querying Observations rely upon queries
      using <a href="https://www.hl7.org/fhir/observation.html#search">component-code</a> and <a
        href="https://www.hl7.org/fhir/observation.html#search">
        component-value-concept</a> search parameters.
    </li>
    <li>More complex queries are also using the <a
      href="https://www.hl7.org/fhir/search.html#revinclude">
      _include
    </a> search parameter.
    </li>
  </ol>

  <a name="specimenIdentification"></a>
  <h3>Specimen Identification</h3>
  <ul>
    <li>Germline testing for biomarkers/mutations (usually inherited)</li>
    <li>Tumor testing for biomarkers/mutations (somatic / tumor specific)</li>
  </ul>
  <a name="germline"></a>
  <h4>Get references to all variants obtained where the analysis has been designated as germline.
  </h4>
  <p>
    This query uses LOINC code 48002-0 for “Genomic Source Class," part of the variant profile of
    Observation variant. "component-code-value-concept" is a construct to use the code of a
    component and the code of a value for the component. The value in this case is "Germline" with
    LOINC code LA6683-2.
  </p>
  <pre class="http">
  GET /Observation?component-code-value-concept=http://loinc.org|48002-0$http://loinc.org|LA6683-2
  </pre>
  <p>
    48002-0: LOINC code for “Genomic Source Class”
  </p>
  <p>
    LA6683-2: LOINC answer code for “Germline”
  </p>
  <p>
    *Return a bundle of genetics Observation instances
  </p>
  <a name="somatic"></a>
  <h4>Get references to all variants obtained where the analysis has been designated as somatic for
    a specific specimen.
  </h4>
  <p>
    This query uses LOINC code 48002-0 for “Genomic Source Class," part of the variant profile of
    Observation variant. "component-code-value-concept" is a construct to use the code of a
    component and the code of a value for the component. The value in this case is "Somatic" with
    LOINC code LA6684-0. Also, the query constrains to specimen with id 1234. ID in this case refers
    to a specific instance of specimen. The specimen id query queries the specimen linked to a
    specific instance of Observation variant.
  </p>
  <pre class="http">
  GET /Observation?component-code-value-concept=http://loinc.org|48002-0$http://loinc.org|LA6684-0&amp;specimen:Specimen=1234
  </pre>
  <p>
    48002-0: LOINC code for “Genomic Source Class”
  </p>
  <p>
    LA6684-0: LOINC answer code for “Somatic”
  </p>
  <p>
    *Return a bundle of genetics Observation instances
  </p>
  <a name="cancerProfiling"></a>
  <h4>Cancer Profiling</h4>
  <p>
    The goal of this profile methodology is to get references from all variants obtained from
    somatic analysis that were identified as having somatic origin. Changes in the population of
    cells with particular mutations will change overtime as well as in conjunction with events such
    as therapy. For instance, targeted chemotherapy may kill a specific population of cancer cells
    with specific mutations and other cancer cell populations may survive and continue to divide.
    Therefore, clearly annotating these specimens as somatic variants and capturing annotations
    related to a time relevant to a treatment time-line may be critical for analysis.

    The following query retrieves all variants annotated as somatic which arrived on July 4, 2015.
    This query uses LOINC code 48002-0 for “Genomic Source Class," part of the variant profile of
    Observation variant. "component-code-value-concept" is a construct to use the code of a
    component and the code of a value for the component. The value in this case is "Somatic" with
    LOINC code LA6684-0. Additionally, the query constrains to those instances where the date field
    equals "2015-07-04."
  </p>
  <pre class="http">GET /Observation?subject:Patient=123&amp;component-code-value-concept=http://loinc.org|48002-0$http://loinc.org|LA6684-0&amp;date=2015-07-04</pre>
  <p>
    48002-0: LOINC code for “Genomic Source Class”
  </p>
  <p>
    LA6684-0: LOINC answer code for “Somatic”
  </p>
  <p>
    *Return a bundle of genetics Observation instances
  </p>
  <a name="clinicalSequencing"></a>
  <h4>Clinical Sequencing – Germline Testing</h4>

  <a name="allObsVariants"></a>
  <h5>
    Get all observed variants for a specific patient.
  </h5>
  <p>The query below retrieves specifically the variants which are directly attributed to the
    patient. The Observation Variant profile uses LOINC code 69548-6 for the value of
    Observation.code. In this case the query is constrained by a Patient with id "123.

    Note to the implementer: It is currently beyond this spec to follow specimen links to Patient
    ids. Some variants maybe reported only with a link to a specimen. In this case a query must
    first be performed to find all specimens related to the patient and then the query for all
    variants related to the specimen can be run. Or, one could devise a more complicated query which
    finds all variants for all specimens of a patient. This is currently left as an exercise, also
    there are questions about performance which are determinant on the data store layer underneath
    the server.
  </p>
  <pre class="http">GET /Observation?subject:Patient=123&amp;code=http://loinc.org|69548-6</pre>
  <p>
    69548-6: LOINC code for “Genetic variant assessment”
  </p>
  <a name="allObsVariantsSpecimen"></a>
  <h5>Get all variants for a specific specimen. The Observation Variant profile uses LOINC code
    69548-6 for the value of Observation.code. In this case constrained by a specimen with id "123."
  </h5>
  <pre class="http">GET /Observation?specimen:Specimen=123&amp;code=http://loinc.org|69548-6</pre>
  <p>
    69548-6: LOINC code for “Genetic variant assessment”
  </p>
  <a name="unknownSignificance"></a>
  <h5>
    For a chart review, get references to all DNA sequences related to mutations with an
    interpretation “Unknown Significance” for a specific Patient.
  </h5>
  <p>The following query returns all the related haplotype, genotype and variant calls which have
    been annotated with "Unknown Significance." This query uses LOINC code 53037-8 for “Genetic
    disease sequence variant interpretation," part of the variant profile of Observation variant.
    "code-value-concept" is a construct to use the code of an observation and the code of a value
    for the Observation instance. The value in this case is "Unknown Significance" with LOINC code
    LA6682-4. Additionally, the "_include:iterate=Observation:derived-from" iteratively follows the
    Observation.derived-from link. "_include:iterate=Observation:derived-from" tells the FHIR API to
    look for variants that the annotation of "Unknown Significance" is derived from. The iterate
    modifier is needed as the direct target of a derived-from relationship can be a hapolotype which
    has a derived-from relationship to a variant (note: haplotypes can have derived-from other
    haplotypes which makes the number of observations returned larger).

    Note to the implementer: It is currently beyond this spec to follow specimen links to Patient
    ids. Some variants maybe reported only with a link to a specimen. In this case a query must
    first be performed to find all specimens related to the patient and then a query for all
    variants related to each patient specimen can be run. Or, one could devise a more complicated
    query which finds all variants for all specimens of a patient. This is currently left as an
    exercise, also there are questions about performance which are determinant on the data store
    layer underneath the server.

    It maybe safer to perform both a subject and specimen query to ensure all reported variants for
    a patient are found.

  </p>

  <pre class="http">GET /Observation?subject:Patient=123&amp;code-value-concept=http://loinc.org|53037-8$http://loinc.org|LA26333-7&amp;_include:iterate=Observation:derived-from</pre>

  <p>
    53037-8: LOINC code for “Genetic disease sequence variant interpretation”
  </p>
  <p>
    LA6682-4: LOINC answer code for “Unknown Significance”.
  </p>
  <p>
    "_include:iterate=Observation:derived-from" tells the FHIR API to look for variants that the
    annotation of "Unknown Significance" is derived from. The iterate modifier is needed as the
    direct target of a derived-from relationship can be a hapolotype which has a derived-from
    relationship to a variant (note: haplotypes can have derived-from other haplotypes which makes
    the number of observations returned larger).
  </p>

  <!--
  Observation?code=69548-6&_include=Observation:subject&subject:Patient.name=Bret
  Observation?_include=Observation:subject&subject:Patient.family=Williams
  Observation?code=6768-6&subject:Patient.family=Williams&_include=Observation:subject

  Patient?name=Bret&_revinclude=Observation:subject&

  &component-value-concept=http://varnomen.hgvs.org|9:g.5073770G>T

code=69548-6&_include=Observation:
-->
  <a name="decisionMaking"></a>
  <h4>Decision Making Tools - Family History and Drug Dosage Calculators</h4>
  <p>
    Today clinicians translate (i.e. manually re-enter) genetic data into tools for decision making.
    This includes family history tools and drug dosage calculators. In the future, this data will
    automatically be incorporated into clinical decision making tools.

    This query returns all the reported variants with referenced medication implications and those
    implications.

    This query uses LOINC code 53037-8 for “Genetic disease sequence variant interpretation," part
    of the variant profile of Observation variant. "component-code" is a construct to use the code
    of a component. The value in this case is "Medication Assessed" with LOINC code 51963-7.
    Additionally, the "_include:iterate=Observation:derived-from" iteratively follows the
    Observation.derived-from link. "_include:iterate=Observation:derived-from" tells the FHIR API to
    look for variants that the medication assessment is derived from. The iterate modifier is needed
    as the direct target of a derived-from relationship can be a hapolotype which has a derived-from
    relationship to a variant (note: haplotypes can have derived-from other haplotypes which makes
    the number of observations returned larger).

  </p>
  <a name="getPharmacogenomic"></a>
  <pre class="http">GET /Observation?subject=123&amp;Observation?component-code=http://loinc.org|51963-7&amp;_include:iterate=Observation:derived-from</pre>
  <p>
    51963-7 : LOINC code for “Medication Assessed”
  </p>
  <p>
    "_include:iterate=Observation:derived-from" tells the FHIR API to look for variants that the
    medication assessment is derived from. The iterate modifier is needed as the direct target of a
    derived-from relationship can be a hapolotype which has a derived-from relationship to a variant
    (note: haplotypes can have derived-from other haplotypes which makes the number of observations
    returned larger).
  </p>
  <a name="publicHealth"></a>
  <h4>Public Health</h4>
  <p>
    Today Registrars manually translate clinical data into public health reporting systems. This
    data is used to monitor and improve public health (e.g. surveillance and clinical research). In
    the future, this data will be extracted from the EHR in an automated (or semi-automated)
    fashion.
  </p>
  <p>
    For a breast cancer clinical genomic study, get all genetic observations of patients where the
    variant is associated with breast cancer as a genetic risk. There is some heterogenity in the
    codes which maybe used to indicate phenotypes. Here we have used the NCI metathesaurus code for
    Breast Cancer, "C9335," as a likely code to be used. The following query returns all variants
    that have an annotation of "Breast Cancer" using the NCI metathesaurus code for Breast Cancer,
    "C9335."

    "code-value-concept" is a construct to use the code of an Observation instance and the code of a
    value for the Observation. The Observation.code = 81259-4, "Associated Phenotype," is used for
    the iG's "Inherited Disease Pathogenicity" profile. The value in this case is NCI metathesaurus
    code for Breast Cancer, "C9335." Additionally, the "_include:iterate=Observation:derived-from"
    iteratively follows the Observation.derived-from link.
    "_include:iterate=Observation:derived-from" tells the FHIR API to look for variants that the
    annotation is derived from. The iterate modifier is needed as the direct target of a
    derived-from relationship can be a hapolotype which has a derived-from relationship to a variant
    (note: haplotypes can have derived-from other haplotypes which makes the number of observations
    returned larger).

  </p>
  <pre class="http">GET /Observation?subject:Patient=123&amp;code-value-concept=http://loinc.org|81259-4$http://ncimeta.nci.nih.gov|C9335&amp;_include:iterate=Observation:derived-from</pre>

  <p>
    81259-4: LOINC code for "Associated Phenotype"
  </p>
  <p>
    http://ncimeta.nci.nih.gov|C9335 : NCI metathesaurus code for "Breast Cancer"
  </p>
  <p>
    "_include:iterate=Observation:derived-from" tells the FHIR API to look for variants that the
    annotation of "Unknown Significance" is derived from. The iterate modifier is needed as the
    direct target of a derived-from relationship can be a hapolotype which has a derived-from
    relationship to a variant (note: haplotypes can have derived-from other haplotypes which makes
    the number of observations returned larger).
  </p>


  <a name="clinicalResearch"></a>
  <h3>Clinical and Research Data Warehouse</h3>
  <p>
    Health data warehousing should persist data in its standardized formats, while allowing users to
    export subsets of the data in the warehouse into multiple ‘data marts’, optimized for specific
    use cases, analysis type or reporting needs.
  </p>
  <!--
  <p>
    Get all genetic observations of patients with the variant c.181T>G
  </p>
  <pre class="http">GET /Observation?component-code-value=http://www.ncbi.nlm.nih.gov/projects/SNP|rs58238560</pre> Do it like this: SNP via rsID, Not complete


  -->
    <p>
    The query:<br></br>
    <b>GET /Observation?subject:Patient=123&amp;code=http://loinc.org|69548-6&amp;component-code-value-concept=http://loinc.org|48018-6$https://www.genenames.org/data/gene-symbol-report/#!/hgnc_id|HGNC:644</b> <br></br>
    will return all the variants associated with the specific patient where the Androgen Receptor (HGNC:644) is the gene name, whether a grouping observation is used or not. This is because the query looks first for all observations associated with the patient, then it filters by the observation.code to keep only those profiles which are variant profile instances. Next,the query retrieves the gene name from those profiles using the component.code and compares the coded-value to "HGNC:644." More queries and explanations can be found on the <a href="usecases.html"> query guidance page</a>.
  </p>
  <p>
    <b>Important:</b> If using grouping observations as results of a report, be sure to also reference the genomic observations. It is up to receiving systems to arrange/use the genomic observations appropriately. But some systems may only process just the first layer of a Diagnostic Report results. Thus, be sure to include result links to all the genomic observation results being returned. Consider using summaryOf for creating meaningful subsets of observations. Additionally, observations may not always be encapsulated in a DiagnosticReport. The use of basing queries on Observation resource, as done here, ensures that genomic observations will be found.<br></br>
  </p>
  
  <p>
    Similarly, at this time be sure to follow all references, and layers, when processing <code>DiagnosticReport.results</code> to ensure that all genomic observations have been processed. For example, just looking at the result references in the report does not ensure that grouped genomic observations have been processed. For example, if a lab were to not follow good practice and send only grouping observations as results for report, then one would need to follow the references in those grouping observations to see the genomic observations. 
  </p>
  <a name="getCompoundHetVariantAndmemberVariants"></a>
  <h4>Compound heterozygotic variant retrieval</h4>
  <p>
    This query returns compound herterozygotic variant observations and the variant observations
    they are composed from. Adding a patient or specimen identifier would filter the result to a
    specific patient or specimen.

    This query uses LOINC code 81263-6 for a component with code of “Complex variant type," part of
    the variant profile of Observation variant. "component-code-value-concept" is a construct to use
    the code of a component and the code of a value for the component. The value in this case is
    "Compound heterozygous" with LOINC code LA26217-2. Additionally,
    "_include:iterate=Observation:has-member" tells the FHIR API to look for variants that compose
    the complex variant. The iterate modifier is used as complex variants can have nested variants.

  </p>
  <pre class="http">GET /Observation?component-code-value-concept=http://loinc.org|81263-6$http://loinc.org|LA26217-2&amp;_include:iterate=Observation:has-member
  </pre>
  <p>
    81263-6: LOINC code for “Complex variant type”
  </p>
  <p>
    LA26217-2: LOINC answer code for “Compound heterozygous”.
  </p>
  <p>
    "_include:iterate=Observation:has-member" tells the FHIR API to look for variants that compose
    the complex variant. The iterate modifier is used as complex variants can have nested variants.
  </p>
  <a name="booleanQueries"></a>
  <h4>
    Search for variants with a given gene <!--and variant classification-->
  </h4>
  <p>
    This query uses the value of the "Gene studied ID (HGNC)" component, with LOINC code 48018-6, to
    find an instance of Observation Variant with the HGNC id for EGFR.
    "component-code-value-concept" is a construct to use the code of a component and the code of a
    value for the component. The value in this case is HGNC gene id "HGNC:3236" for EGFR. Note to
    avoid errors, the gene id's from HGNC must be appended with "HGNC:"
  </p>
  <!--pre class="http">GET /Observation?component-code-value=http://www.genenames.org|3236&amp;component-code-value=http://loinc.org|LA6684-0</pre-->
  <pre class="http">
  GET /Observation?component-code-value-concept=http://loinc.org|48018-6$https://www.genenames.org/data/gene-symbol-report/#!/hgnc_id|HGNC:3236
  </pre>
  <!--pre class="http">GET /Observation?subject:Patient=123&amp;code-value-concept=http://loinc.org|53037-8$http://loinc.org|LA26333-7&amp;_include:iterate=Observation:derived-from</pre-->
  <p>
    48018-6: LOINC code for “Gene studied ID (HGNC)”
  </p>
  <p>
    https://www.genenames.org/data/gene-symbol-report/#!/hgnc_id|HGNC:3236 : HGNC id for EGFR
  </p>
  <a name="variant ID"></a>
  <h4>Variant ID based query</h4>
  <p>
    Find all patients with a set of variants identified by a variant id. In this case we are looking
    to see if there is an observation of ClinVar ID 182302. Which has HGVS of
    NM_000059.3:c.1-59_1-57delGAA.

    This query uses the value of the "Discrete Genetic Variant" component, with LOINC code 81252-9,
    to find an instance of Observation Variant with a ClinVar id "182302."
    "component-code-value-concept" is a construct to use the code of a component and the code of a
    value for the component. The value in this case is ClinVar ID 182302.
  </p>
  <pre class="http">GET /Observation?component-code-value-concept=http://loinc.org|81263-6$http://www.ncbi.nlm.nih.gov/clinvar|182302
  </pre>
  <p>
    81252-9: LOINC code for “Discrete Genetic Variant”
  </p>
  <p>
    http://www.ncbi.nlm.nih.gov/clinvar/variation|182302: ClinVar ID 182302
  </p>
  <!--pre class="http">GET /Observation?component-code-value=http://www.ncbi.nlm.nih.gov/projects/SNP|rs58238560$rs58238559$rs58238565</pre>
  <p>
    rs58238560: variant: NC_000017.10:g.497469T>A

    rs58238559: variant: NC_000007.13:g.87082273T>C

    rs58238565: variant: NC_000005.10:g.131929452C>A
  </p-->

  <a name="getAPatient"></a>
  <h4>Get a Patient's Family members' genetics report</h4>
  <p>
    This example is proposed by Kevin Hughes. Family history is useful for clinicians to know more
    about the condition of the patient. This uses the FamilyMemberHistory extension to find the
    family history of patient "123."
  </p>
  <pre class="http">GET /FamilyMemberHistory?patient=123</pre>
  <a name="other"></a>
  <h3>Other Genomics Use Case</h3>
  <p>
    During the development of the FHIR Genomics design, CGWG participants have commented on the
    earlier use cases and/or proposed new use cases. In this section, we list describe new cases and
    demonstrate how the proposed design will address them.
  </p>
  <a name="panel"></a>
  <h4>Panel</h4>
  <p>
    Search for results from nephrotic syndrome panel
  </p>
  <!--pre class="http">GET /DiagnosticReport?code=N0336&amp;patient=123</pre-->

  <a name="basicQueries"></a>
  <h4>Basic Queries</h4>
  <p>
    Find patients by condition and affected status
  </p>
  <pre class="http">GET /Condition?component-code-value=http://snomed.info/sct|439401001</pre>
  <p>
    Find patients by phenotypical attribute
  </p>
  <!--pre class="http">GET /Observation?CodeableConcept=http://loinc.org|79716-7</pre>
  <p>
    79716-7: LOINC code for “CYP2C9 gene product metabolic activity interpretation”
  </p-->

  <!--
  <p>
    Find patients by molecular data type available
  </p>
  <pre class="http">GET /Observation?DNARegionName=NC_000017.10:g.497469T>A</pre>
  <p>
    53035-2: LOINC code for “DNA marker assessed"
  </p>
  <p>
    Find mutation by mutation type and position
  </p>
  <pre class="http">GET /Observation?_profile=http://hl7.org/fhir/StructureDefinition/observation-geneticsVariant&amp;Name=NM_000059.3:c.706C;A&amp;Type=http://loinc.org|81289-1</pre>
-->
  <p>
    Find patients based on mode of inheritance (genomic region, position, gene, SNP)
  </p>
  <!--pre class="http">GET /FamilyMemberHistory?reasonCode=http://snomed.info/sct|272398008</pre>
  <p>
    7272398008: SNOMED code for “ Inheritance types "
  </p-->
  <p>
    Search for patient by ID
  </p>
  <pre class="http">GET /Patient?subject=123</pre>


  <p>
    Search for patients based on genetic ancestry
  </p>
  <!--pre class="http">GET /Observation?component-code-value=http://www.genenames.org|186044009&amp;component-code-value=http://snomed.info/sct|LA6684-0</pre-->


  <a name="specimenBased"></a>

  <h4>Specimen-based Queries</h4>
  <p>
    Find specimens collected from specific specimen body sites
  </p>
  <pre class="http">GET /Observation?component-code-value=http://snomed.info/sct|85151006</pre>

  <!--
  <p>
    Find specimens from this patient's pedigree
  </p>
  <pre class="hhtp">GET /FamilyMemberHistory?patient=123</pre>

  <p>
    Find specimens based on patient disease status
  </p>
  <pre class="http">GET /Observation?component-code-value=http://snomed.info/sct|254837009&amp;subject=123</pre>
  -->
  <p>
    Find specimens based on specimen status
  </p>
  <pre class="http">GET /Specimen?status=available</pre>
  <p>
    Find specimens based on technology platform
  </p>
  <pre class="http">GET /Specimen?code=Information Technology</pre>
  <p>
    Find specimens based on instrument identifier
  </p>
  <pre class="http">GET /Specimen?container.identifier=48736-15394-75465</pre>

  <a name="timeBased"></a>
  <h4>Time-Based Queries</h4>
  <p>
    Find specimens collected within an absolute date range
  </p>
  <pre class="http">GET /Specimen?receivedTime=2011-03-04T07:03:00Z</pre>
  <!--p>
      Find specimens collected within a relative date range
  </p>
  <pre class="http">GET /Specimen?duration=quot</pre-->

</div>
